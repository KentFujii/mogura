#!/usr/bin/env ruby

require "bundler/setup"
require 'mogura'
require 'thor'
module Mogura
  module CLI
    class Runner < Thor
      desc 'version', 'Prints version'
      def version
        say "Mogura #{Mogura::VERSION}"
      end

      desc 'init', 'Initialize a Digdag project'
      method_option :project, aliases: '-p', type: :string, desc: 'Project of Digdag'
      def init
        opts = options.to_h.symbolize_keys
        Mogura::Init.init(**opts.freeze)
      end

      desc 'push', 'Push a Digdag project'
      method_option :endpoint, aliases: '-e', type: :string, desc: 'Endpoint of Digdag'
      def push
        opts = options.to_h.symbolize_keys
        Mogura::Push.push(**opts.freeze)
      end
    end
  end
end

Mogura::CLI::Runner.start